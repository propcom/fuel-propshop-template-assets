(function(d,e){function f(a,b){for(var c=0,d=a.length,e=[];c<d;c++)e[c]=b(a[c],c);return e}function g(a){return a}function c(a,b){var n=this;b=b||{};void 0!==a&&("string"===typeof a?(b.selector=a,a=void 0):"undefined"===typeof a.length&&(b=a,a=void 0));this.imagesOffScreen=[];this.viewportHeight=e.documentElement.clientHeight;this.selector=b.selector||".js-image-load";this.className=b.className||"image-replace";this.gif=e.createElement("img");this.gif.src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7";
this.gif.alt="";this.scrollDelay=b.scrollDelay||250;this.onResize=b.hasOwnProperty("onResize")?b.onResize:!0;this.lazyload=b.hasOwnProperty("lazyload")?b.lazyload:!1;this.scrolled=!1;this.availablePixelRatios=b.availablePixelRatios||[1,2];this.availableWidths=b.availableWidths||l;this.onImagesReplaced=b.onImagesReplaced||function(){};this.widthsMap={};this.refreshPixelRatio();this.widthInterpolator=b.widthInterpolator||g;"function"!==typeof this.availableWidths&&("number"===typeof this.availableWidths.length?
this.widthsMap=c.createWidthsMap(this.availableWidths,this.widthInterpolator):(this.widthsMap=this.availableWidths,this.availableWidths=m(this.availableWidths)),this.availableWidths=this.availableWidths.sort(function(a,b){return a-b}));a?(this.divs=f(a,g),this.selector=null):this.divs=f(e.querySelectorAll(this.selector),g);this.changeDivsToEmptyImages();h(function(){n.init()})}var l,m,h,k;h=d.requestAnimationFrame||d.mozRequestAnimationFrame||d.webkitRequestAnimationFrame||function(a){d.setTimeout(a,
1E3/60)};k=function(){return e.addEventListener?function(a,b,c){return a.addEventListener(b,c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}();l=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736];m="function"===typeof Object.keys?Object.keys:function(a){var b=[],c;for(c in a)b.push(c);return b};c.prototype.updateDivs=function(){var a=this;f(e.querySelectorAll(this.selector),function(b){a.divs.push(b)});this.changeDivsToEmptyImages();h(function(){a.init()})};c.prototype.scrollCheck=
function(){this.scrolled&&(this.imagesOffScreen.length||d.clearInterval(this.interval),this.divs=this.imagesOffScreen.slice(0),this.imagesOffScreen.length=0,this.changeDivsToEmptyImages(),this.scrolled=!1)};c.prototype.init=function(){this.initialized=!0;this.checkImagesNeedReplacing(this.divs);this.onResize&&this.registerResizeEvent();this.lazyload&&this.registerScrollEvent()};c.prototype.createGif=function(a){if(a.className.match(new RegExp("(^| )"+this.className+"( |$)")))return a;var b=this.gif.cloneNode(!1);
b.width=a.getAttribute("data-width");b.height=a.getAttribute("data-height");b.className=(a.getAttribute("data-class")?a.getAttribute("data-class")+" ":"")+this.className;a.getAttribute("data-zoom-image")&&b.setAttribute("data-zoom-image",a.getAttribute("data-zoom-image"));b.setAttribute("data-src",a.getAttribute("data-src"));b.setAttribute("alt",a.getAttribute("data-alt")||this.gif.alt);a.parentNode&&a.parentNode.replaceChild(b,a);return b};c.prototype.changeDivsToEmptyImages=function(){var a=this;
f(this.divs,function(b,c){a.lazyload?a.isThisElementOnScreen(b)?a.divs[c]=a.createGif(b):a.imagesOffScreen.push(b):a.divs[c]=a.createGif(b)});this.initialized&&this.checkImagesNeedReplacing(this.divs)};c.prototype.isThisElementOnScreen=function(a){var b=c.getPageOffset(),d=0;if(a.offsetParent){do d+=a.offsetTop;while(a=a.offsetParent)}return d<this.viewportHeight+b?!0:!1};c.prototype.checkImagesNeedReplacing=function(a){var b=this;this.isResizing||(this.isResizing=!0,this.refreshPixelRatio(),f(a,
function(a){b.replaceImagesBasedOnScreenDimensions(a)}),this.isResizing=!1,this.onImagesReplaced(a))};c.prototype.replaceImagesBasedOnScreenDimensions=function(a){var b;b="function"===typeof this.availableWidths?this.availableWidths(a):this.determineAppropriateResolution(a);b=d.getComputedStyle?0===b||"hidden"===d.getComputedStyle(a,null).getPropertyValue("visibility")?this.gif.src:this.changeImageSrcToUseNewImageDimensions(a.getAttribute("data-src"),b):this.changeImageSrcToUseNewImageDimensions(a.getAttribute("data-src"),
b);a.src=b};c.prototype.determineAppropriateResolution=function(a){return 0===a.clientWidth?c.getClosestValue(a.clientWidth,this.availableWidths):c.getClosestValue(e.body.clientWidth,this.availableWidths)};c.prototype.refreshPixelRatio=function(){this.devicePixelRatio=c.getClosestValue(c.getPixelRatio(),this.availablePixelRatios)};c.prototype.changeImageSrcToUseNewImageDimensions=function(a,b){return a.replace(/{width}/g,c.transforms.width(b,this.widthsMap)).replace(/{pixel_ratio}/g,c.transforms.pixelRatio(this.devicePixelRatio))};
c.getPixelRatio=function(a){return(a||d).devicePixelRatio||1};c.createWidthsMap=function(a,b){for(var c={},d=a.length;d--;)c[a[d]]=b(a[d]);return c};c.transforms={pixelRatio:function(a){return 1===a?"":"-"+a+"x"},width:function(a,b){return b[a]||a}};c.getClosestValue=function(a,b){for(var c=b.length,d=b[c-1];c--;)a<=b[c]&&(d=b[c]);return d};c.prototype.registerResizeEvent=function(){var a=this;k(d,"resize",function(){a.checkImagesNeedReplacing(a.divs)})};c.prototype.registerScrollEvent=function(){var a=
this;this.scrolled=!1;this.interval=d.setInterval(function(){a.scrollCheck()},a.scrollDelay);k(d,"scroll",function(){a.scrolled=!0})};c.getPageOffsetGenerator=function(a){return a?function(){return d.pageYOffset}:function(){return e.documentElement.scrollTop}};c.getPageOffset=c.getPageOffsetGenerator(Object.prototype.hasOwnProperty.call(d,"pageYOffset"));c.applyEach=f;"object"===typeof module&&"object"===typeof module.exports?module.exports=exports=c:"function"===typeof define&&define.amd?define(function(){return c}):
"object"===typeof d&&(d.Imager=c)})(window,document);